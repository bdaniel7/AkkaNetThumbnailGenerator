---
layout: post
title: "Use Zend Framework on IIS"
date: 2006-10-15 20:45:00 +0000
comments: true
published: true
categories: ["post"]
tags: ["General", "PHP"]
alias: ["/post/2006/10/15/use-zend-framework-on-iis.aspx"]
author: Maarten Balliauw
redirect_from:
 - /post/2006/10/15/use-zend-framework-on-iis.aspx.html
 - /post/2006/10/15/use-zend-framework-on-iis.aspx.html
---
<p><a href="/images/WindowsLiveWriter/UseZendFrameworkonIIS_94C6/zend_fw.jpg" mce_href="/images/WindowsLiveWriter/UseZendFrameworkonIIS_94C6/zend_fw.jpg" atomicselection="true"><img src="/images/WindowsLiveWriter/UseZendFrameworkonIIS_94C6/zend_fw_thumb.jpg" style="border: 0px none ; margin: 5px;" mce_src="/images/WindowsLiveWriter/UseZendFrameworkonIIS_94C6/zend_fw_thumb.jpg" align="left" border="0" height="76" width="119"></a> A while ago, I was experimenting with the <a href="http://framework.zend.com" mce_href="http://framework.zend.com">Zend Framework</a>. At first, I tried running a small sample on top of IIS, but unfortunately, that did not work... On Apache, it worked like a charm. Very nice, but what do you do when your site runs on an IIS machine? </p><p>I started experimenting. First of all, I found out that Zend Framework also accepts URL's like <a href="http://www.balliauw.be/localhost/index.php/controller/action/" mce_href="http://www.balliauw.be/localhost/index.php/controller/action/">http://localhost/index.php/controller/action/</a> as well as <a href="http://www.balliauw.be/localhost/controller/action/" mce_href="http://www.balliauw.be/localhost/controller/action/">http://localhost/controller/action/</a>. The first one is really handy! The only thing you have to do is to feed index.php the right query string and you're up and running. Changing all your URL's from /x/y to index.php/x/y should do the trick. </p><p>But this does not look pretty in my browser. I don't want the index.php in between! </p><p>Searching Google, I found some ISAPI filters that provide URL rewriting, but none of them are free. As a Belgian, I don't like spending my money when results are not guaranteed. Luckily, another idea popped up in my mind: let's fool IIS! Everybody using IIS knows that you can customize your 404 (page not found) error page. What about trapping all 404's to a central page, that can dispatch the request to my index.php file? A schematic overview: </p><p><a href="/images/WindowsLiveWriter/UseZendFrameworkonIIS_94C6/zf_iis_1%5B15%5D.gif" mce_href="/images/WindowsLiveWriter/UseZendFrameworkonIIS_94C6/zf_iis_1%5B15%5D.gif" atomicselection="true"><img src="/images/WindowsLiveWriter/UseZendFrameworkonIIS_94C6/zf_iis_1_thumb%5B15%5D.gif" style="margin: 5px;" mce_src="/images/WindowsLiveWriter/UseZendFrameworkonIIS_94C6/zf_iis_1_thumb%5B15%5D.gif" border="0" height="553" width="372"></a>  </p><p>I assume&nbsp; you are familiar with configuring IIS and its error pages. All you have to do is <a href="http://www.balliauw.be/maarten/media/File/RewriteController.aspx.txt" mce_href="http://www.balliauw.be/maarten/media/File/RewriteController.aspx.txt">save this file as RewriteController.aspx</a>, and point your 404 error page there. </p><p>Now go ahead and try! The RewriteController.aspx changes the internal request in IIS from <a href="http://www.balliauw.be/localhost/index/index" mce_href="http://www.balliauw.be/localhost/index/index">http://localhost/index/index</a> (default action) to <a href="http://www.balliauw.be/localhost/index.php/index/index" mce_href="http://www.balliauw.be/localhost/index.php/index/index">http://localhost/index.php/index/index</a>. The address bar of your browser stays the same thoug. Subsequent requests are all routed this way, which means you can keep using your path's without index.php in between. </p><p>Some remarks: </p><ul> <li>If Zend Framework always tries the no route action, try using Zend_Controller_RewriteRouter instead of the default Zend_Controller_Router.  </li><li>RewriteController.aspx can be rewritten in another scripting language too, but ASP.NET provides some nice shorthands to server variables...  </li><li>Routing all errors trough RewriteController.aspx is probably a small performance bottleneck. Not noteworthy, but on high-traffic websites I expect this to slow things down  </li><li>Another best practice on the Zend Framework is to redirect the noRoute to some sort of a 404 page</li></ul>
{% include imported_disclaimer.html %}
